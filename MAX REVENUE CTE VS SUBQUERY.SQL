-- MAX REVENUE FOR YEARLY SALES
WITH CTE AS (SELECT YEAR_ID, ROUND(SUM(SALES),2) AS REV
FROM sales_data_for_rfm_segmentation
GROUP BY 1
ORDER BY 2 DESC)

SELECT MAX(REV) FROM CTE;

-- SAME AS SUBQUERY
SELECT MAX(REV) FROM
(SELECT YEAR_ID, ROUND(SUM(SALES),2) AS REV
FROM sales_data_for_rfm_segmentation
GROUP BY 1
ORDER BY 2 DESC)
X;

