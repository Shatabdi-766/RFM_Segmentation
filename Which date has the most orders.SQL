-- Which date has the most sales?
SELECT ORDERDATE_1, COUNT(ORDERNUMBER) AS FREQUENCY, ROUND(SUM(SALES),2) AS REVENUE
FROM sales_data_for_rfm_segmentation
GROUP BY 1
ORDER BY 3 DESC
LIMIT 1;

-- SAME AS CTE
WITH CTE AS (SELECT ORDERDATE_1, COUNT(ORDERNUMBER) AS FREQUENCY, ROUND(SUM(SALES),2) AS REVENUE
FROM sales_data_for_rfm_segmentation
GROUP BY 1
ORDER BY 3 DESC)

SELECT REVENUE FROM CTE
LIMIT 1;

-- MOST SALES USED HAVING
SELECT ORDERDATE_1, COUNT(ORDERNUMBER) AS FREQUENCY, ROUND(SUM(SALES),2) AS SALES
FROM sales_data_for_rfm_segmentation
GROUP BY 1
HAVING MAX(SALES) ;

-- SAME AS ABOVE USED CTE
WITH CTE AS(SELECT ORDERDATE_1, COUNT(ORDERNUMBER) AS FREQUENCY, ROUND(SUM(SALES),2) AS SALES
FROM sales_data_for_rfm_segmentation
GROUP BY 1)
SELECT MAX(SALES) FROM CTE;
